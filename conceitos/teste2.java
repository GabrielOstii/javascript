/*************************************************************************************************
 *             Modelo de Etiqueta EPL - NÃO ALTERAR!                                                                                                                *
 *************************************************************************************************/
import erp3.printer.comm.printcomm.*;
import erp3.util.*;
import java.util.HashMap;
import java.util.Set;
import java.text.SimpleDateFormat;
import java.util.Date;

StringBuffer codigo = new StringBuffer();

/*************************************************************************************************
 * 1) Envia uma linha de Etiquetas para a Impressora, orientando-se pela quantidade máxima de colunas                         *
 *************************************************************************************************/
private void enviarParaImpressora() {
    PrintComm.sendTextToPrinter(IMPRESSORA_ETIQUETA, "Etiqueta", codigo.toString(), "^XA\n\r", "^XZ\n\r");
    codigo = new StringBuffer();
}

public void main() {
      
       for (int s = INICIO; s <= VOLUME ; s++) { 

           /* LOGO MARCA */
           codigo.append("^FO10,40^GFA,4028,4028,38,,:::Q01C,Q03E,Q0FF8,P03FFC,P0JF,O01JFC,O0KFE,N01LF8,N07FFE1FFE,N0IF80IF,N0IF803FFC,N03FFC00FFE,L0701IF003FF,K01FC07FF800FF,K07FC01FFE003F,J01FFC007FF001F06,J07FF8007FF8007078,J0FFEI0IF8J07C,I03FF8003FFEK07F,I0IFI07FF8K07FC,003FFC001IF0038007FF,00IF8007FFC00FE007FF8,01FFE001IF001FF007FFE,01FFC007FFE007FFE07IF8,03FFI07FF801JF07IFC,03FCI07FE007JFC7IFC007KFC,03F8I07F800KFE7IFC007KFE,03F80707F003FFCJFE3FC007KFEgI01F8,03F81F07E00IF03IFE0FC007KFEgI03F8,03F87F07E01FFE00IFE0FC007KFEgI03F8,03FDFF07E07FF8007FFE0FCJ03FFgK03F8,01JF07E0FFEI01FFE0FCJ01FEgK03F8,01JF07E0FFCJ07FE0FCJ01FEgK03F8,01JF07E0FF007801FE0FCJ01FEgK03F8,01JF07E0FC01FE00FE0FCJ01FEJ07CF8I07F8K03FI01IFCI03FEJ07F7E,01JF07E0F003FF003E0FCJ01FEJ0IF8003IFK0FFE003IFCI0IF8I07FFE,03JF07E0E003FFC00E0FCJ01FEJ0IF8007IF8I03IF003IFC001IFCI0IFE,03FE3F07EK0IFJ0FCJ01FEJ0IF800JFCI07IF803IFC003IFEI0IFE,03FC3F07EK07FFCI0FCJ01FEJ0IF801FC7FCI07F7FC03IFC007F9FEI0IFE,03F03F07EK01FFEI0FCJ01FEJ0FFE001FC3FCI0FE3FC003F8I0FF0FFI0IFC,03E03F07EL07FF800FCJ01FEJ0FF8003FC1FCI0FE1FC003F8I0FF0FFI0FFC,01803F07EL03FFE00FCJ01FEJ0FFJ0FC1FC001FE1FC003F8I0FE07FI0FFC,J03F07EM0IF00FCJ01FEJ0FFL01FC001FC1FC003F8I0FE07F800FF8,J03F07EM03FFC0FCJ01FEJ0FEL01FC001FC08I03F8I0FE07F800FF8,J03F07EN0FFE0FCJ01FEJ0FEK01FFC003FCK03F8I0FE07F800FF8,J03F07EN07FE0FCJ01FEJ0FEJ01IFC003FCK03F8I0FE07F800FF8,00303F07EN01FE0FCJ01FEJ0FEJ07IFC003FCK03F8I0FE07F800FF8,00F03F03EL0E00FE0F8J01FEJ0FEI01JFC003FCK03F8I0FE07F800FF8,01F03F80EL0F00FE0EK01FEJ0FEI03FF9FC003FCK03F8I0FE07FI0FF8,01F03FCN0FC0FEM01FEJ0FEI03FE1FC003FCK03F8I0FE07FI0FF8,01F03FFN0FC0FEM01FEJ0FEI03FC1FC003FC0FC003F8I0FE07FI0FF8,03F03FFCM0FC0FEM01FEJ0FEI03FC1FC003FC1FC003F8I0FE07FI0FF8,03F01IFM0FC0FEM01FEJ0FEI07FC3FC001FC1FC003F8I0FE07FI0FF8,03F007FFCL0FC0FE00CJ01FEJ0FEI07FC3FC001FE1FC003F8I07F07EI0FF8,03F001FFEL0FC0FE03CJ01FEJ0FEI07FC7FC001FE1FC003F8I07F0FEI0FF8,03FI07FF8K0FC0FE07CJ01FEJ0FEI07FCFFCI0JFC003FEI03F8FCI0FF8,03FI03FFEK0FC0FE1FCJ01FEJ0FEI03JFCI0JF8003FFE001IFCI0FF8,03FJ0IF8J0FC0FC3FCJ01FEJ0FEI03JFCI07IFI03FFEI0IFJ0FF8,03F03003FFC0010FC0FEFFCJ01FEJ0FEI01JFCI03FFEI01FFEI07FEJ0FF,03F07C00FFE0078FC0JFCJ01FEJ0FEJ07FDFCJ0FF8J07FEP07F,03F07E003F801F8FC0JFCX08U08,03F03F800F007F8FC0JFCX04,03F07FEK0FF8FC0JFC007Q01I0BR01U02,03F87FFJ03FF8FC0JFC006CP01gR02,03F87FFCI0IF0FC0JFC0044C331C0C063100C618E06381C06470C0031C7030C670E718,03F87IF001FFE0FE0FFBFC00452C0901208494529250090D820920B28A48280CB2809212,03F87IF807FFC0FE0FE1FC004F2809013084945082500905020920A28A482800A280A21A,03F87IFE1IF00FE0F81FC007BE839C1F0E454500FCC013D1E0927A28A49EE0CBEE7A2738,03FE7MFC00FE0E01FC00420848410034545088020045320924A28A4B2104A034A280C,03JF3KF001FEI03FC0041084821001494D09202014512092CA28A4A2104A014A2904,03JF1JFE007FEI07FC0041E779C0F0E797CEF3DE0F3D1E0927BE7A49EF071EE79EF38,01JF07IF801FFEI0FFCK01Q04U02M04,00JF03FFE003FFC003FFCK01Q04U02M04,003IF00FFC00IF800IF8K06Q0CK08O02M04,I0IF007F003FFE003FFE,I07FF001C007FF800IF8,I01FFK01IF001FFE,J07FK03FFC003FFC,J03FK0IFI0IF,K0FJ01FFE003FFC,K060C003FFC007FF,M0F001IF003FC,M0FC007FFC01F,M0FF001IF004,M0FFC00IFC,M0IF003IF,M03FFC01IF,N0IF03FFE,N07FFCIFC,N01LF,O07JFC,O03JF,P0IFE,P03FF8,Q0FE,Q07C,,:::::^FS");
     
        /* DADOS DA EMPRESA */
       codigo.append("^CF0,25");
       codigo.append("^FO330,30^FD" + RAZAO_SOCIAL + "^FS");       
       codigo.append("^FO330,70^FD CNPJ: " + CNPJ_EMPRESA + "^FS");
       codigo.append("^FO330,110^FD IE: "  + IE_EMPRESA + "^FS");

       /* DADOS DO VOLUME */

       codigo.append("^CF0,40");
       codigo.append("^FO540,200^GB200, 200,100^FS");
       codigo.append("^FO600,250^FR^FDVOL:^FS");
       codigo.append("^CF0,50"); 
       codigo.append("^FO600,310^FR^FD" +s+"/"+ VOLUME + "^FS");

        

       /* CAMPOS FIXOS DO CLIENTE E NOTA */ 
       codigo.append("^CF0,30");
       codigo.append("^FO50,200^FDNF:^FS");
       codigo.append("^FO50,245^FDCLIENTE:^FS");
       codigo.append("^FO50,330^FDCNPJ/CPF:^FS");
       codigo.append("^FO50,375^FDENDERECO:^FS");
       codigo.append("^FO50,455^FDBAIRRO:^FS");
       codigo.append("^FO50,500^FDCIDADE:^FS");
       codigo.append("^FO50,545^FDUF:^FS");
       codigo.append("^FO410,545^FDCEP:^FS");

       /* PREENCHIMENTO DOS CAMPOS DO CLIENTE E NOTA */
      codigo.append("^CFA,30,10");
      codigo.append("^FO110,200^FD" + NUMERO_NOTA + "^FS");
      codigo.append("^FO50,280^FD" + RAZAO_SOCIAL_CLIENTE + "^FS");
      codigo.append("^FO200,330^FD" +  CLIF_CGC_CPF_CLIENTE + "^FS");
      codigo.append("^FO50,410^FD" + ENDERECO_CLIENTE + ", " + CLIF_NUMERO +  "^FS");
      codigo.append("^FO170,455^FD" + BAIRRO_CLIENTE + "^FS");
      codigo.append("^FO160,500^FD" + CIDADE_CLIENTE + "^FS");
      codigo.append("^FO100,545^FD" + UF_CLIENTE + "^FS");
      codigo.append("^FO490,545^FD" + CEP_CLIENTE + "^FS");

      /* DADOS DA TRANSPORTADORA */ 
      codigo.append("^CF0,30");
      codigo.append("^FO20,590^GB740,2,2^FS");
      codigo.append("^FO50,610^FDTRANSPORTADORA:^FS");

      /* PREENCHIMENTO DOS DADOS DA TRANSPORTADORA */
      codigo.append("^CFA,30,10");
      codigo.append("^FO50,650^FD" + TRANSPORTADORA + "^FS");

      /* DADOS DA AGSYSTEM */
      codigo.append("^CFA,20,10");
      codigo.append("^FO490,700^FDby: AGSystem Tecnologia^FS");

       enviarParaImpressora();

      } 

  }

/*************************************************************************************************
 * 5) Invoca o processamento dos produto e exibe as exceções lançadas, caso necessário                                               *
 *************************************************************************************************/
try{
    main();
}catch(Exception e){
  erp3.util.Methods.displayException(e);
}